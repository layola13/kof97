/*!
 * @overview es6-promise - a tiny implementation of Promises/A+.
 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
 * @license   Licensed under MIT license
 *            See https://raw.githubusercontent.com/jakearchibald/es6-promise/master/LICENSE
 * @version   2.0.0
 */
(function(){"use strict";function t(t){return"function"==typeof t}var e=Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)};Date.now;function n(){}Object.create;var r=0,o=function(t,e){_[r]=t,_[r+1]=e,2===(r+=2)&&c()},i="undefined"!=typeof window?window:{},s=i.MutationObserver||i.WebKitMutationObserver,u="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel;var c,a,f,l,h,_=new Array(1e3);function p(){for(var t=0;t<r;t+=2){(0,_[t])(_[t+1]),_[t]=void 0,_[t+1]=void 0}r=0}function d(){}"undefined"!=typeof process&&"[object process]"==={}.toString.call(process)?c=function(){process.nextTick(p)}:s?(f=0,l=new s(p),h=document.createTextNode(""),l.observe(h,{characterData:!0}),c=function(){h.data=f=++f%2}):u?((a=new MessageChannel).port1.onmessage=p,c=function(){a.port2.postMessage(0)}):c=function(){setTimeout(p,1)};var v=void 0,y=1,m=2,w=new M;function b(e,n){if(n.constructor===e.constructor)!function(t,e){e._state===y?j(t,e._result):t._state===m?E(t,e._result):P(e,void 0,(function(e){g(t,e)}),(function(e){E(t,e)}))}(e,n);else{var r=function(t){try{return t.then}catch(t){return w.error=t,w}}(n);r===w?E(e,w.error):void 0===r?j(e,n):t(r)?function(t,e,n){o((function(t){var r=!1,o=function(t,e,n,r){try{t.call(e,n,r)}catch(t){return t}}(n,e,(function(n){r||(r=!0,e!==n?g(t,n):j(t,n))}),(function(e){r||(r=!0,E(t,e))}),t._label);!r&&o&&(r=!0,E(t,o))}),t)}(e,n,r):j(e,n)}}function g(t,e){var n;t===e?E(t,new TypeError("You cannot resolve a promise with itself")):"function"==typeof(n=e)||"object"==typeof n&&null!==n?b(t,e):j(t,e)}function A(t){t._onerror&&t._onerror(t._result),T(t)}function j(t,e){t._state===v&&(t._result=e,t._state=y,0===t._subscribers.length||o(T,t))}function E(t,e){t._state===v&&(t._state=m,t._result=e,o(A,t))}function P(t,e,n,r){var i=t._subscribers,s=i.length;t._onerror=null,i[s]=e,i[s+y]=n,i[s+m]=r,0===s&&t._state&&o(T,t)}function T(t){var e=t._subscribers,n=t._state;if(0!==e.length){for(var r,o,i=t._result,s=0;s<e.length;s+=3)r=e[s],o=e[s+n],r?S(n,r,o,i):o(i);t._subscribers.length=0}}function M(){this.error=null}var O=new M;function S(e,n,r,o){var i,s,u,c,a=t(r);if(a){if(i=function(t,e){try{return t(e)}catch(t){return O.error=t,O}}(r,o),i===O?(c=!0,s=i.error,i=null):u=!0,n===i)return void E(n,new TypeError("A promises callback cannot return that same promise."))}else i=o,u=!0;n._state!==v||(a&&u?g(n,i):c?E(n,s):e===y?j(n,i):e===m&&E(n,i))}function k(t,e,n,r){this._instanceConstructor=t,this.promise=new t(d,r),this._abortOnReject=n,this._validateInput(e)?(this._input=e,this.length=e.length,this._remaining=e.length,this._init(),0===this.length?j(this.promise,this._result):(this.length=this.length||0,this._enumerate(),0===this._remaining&&j(this.promise,this._result))):E(this.promise,this._validationError())}k.prototype._validateInput=function(t){return e(t)},k.prototype._validationError=function(){return new Error("Array Methods must be provided an Array")},k.prototype._init=function(){this._result=new Array(this.length)};var C=k;k.prototype._enumerate=function(){for(var t=this.length,e=this.promise,n=this._input,r=0;e._state===v&&r<t;r++)this._eachEntry(n[r],r)},k.prototype._eachEntry=function(t,e){var n,r=this._instanceConstructor;"object"==typeof(n=t)&&null!==n?t.constructor===r&&t._state!==v?(t._onerror=null,this._settledAt(t._state,e,t._result)):this._willSettleAt(r.resolve(t),e):(this._remaining--,this._result[e]=this._makeResult(y,e,t))},k.prototype._settledAt=function(t,e,n){var r=this.promise;r._state===v&&(this._remaining--,this._abortOnReject&&t===m?E(r,n):this._result[e]=this._makeResult(t,e,n)),0===this._remaining&&j(r,this._result)},k.prototype._makeResult=function(t,e,n){return n},k.prototype._willSettleAt=function(t,e){var n=this;P(t,void 0,(function(t){n._settledAt(y,e,t)}),(function(t){n._settledAt(m,e,t)}))};var R=0;var x=Y;function Y(e){this._id=R++,this._state=void 0,this._result=void 0,this._subscribers=[],d!==e&&(t(e)||function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof Y||function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}(),function(t,e){try{e((function(e){g(t,e)}),(function(e){E(t,e)}))}catch(e){E(t,e)}}(this,e))}Y.all=function(t,e){return new C(this,t,!0,e).promise},Y.race=function(t,n){var r=new this(d,n);if(!e(t))return E(r,new TypeError("You must pass an array to race.")),r;var o=t.length;function i(t){g(r,t)}function s(t){E(r,t)}for(var u=0;r._state===v&&u<o;u++)P(this.resolve(t[u]),void 0,i,s);return r},Y.resolve=function(t,e){if(t&&"object"==typeof t&&t.constructor===this)return t;var n=new this(d,e);return g(n,t),n},Y.reject=function(t,e){var n=new this(d,e);return E(n,t),n},Y.prototype={constructor:Y,then:function(t,e){var n=this,r=n._state;if(r===y&&!t||r===m&&!e)return this;var i=new this.constructor(d),s=n._result;if(r){var u=arguments[r-1];o((function(){S(r,i,u,s)}))}else P(n,i,t,e);return i},catch:function(t){return this.then(null,t)}};var D={Promise:x,polyfill:function(){var e,n;"Promise"in(e="undefined"!=typeof global?global:"undefined"!=typeof window&&window.document?window:self)&&"resolve"in e.Promise&&"reject"in e.Promise&&"all"in e.Promise&&"race"in e.Promise&&(new e.Promise((function(t){n=t})),t(n))||(e.Promise=x)}};"function"==typeof define&&define.amd?define((function(){return D})):"undefined"!=typeof module&&module.exports?module.exports=D:void 0!==this&&(this.ES6Promise=D)}).call(this);