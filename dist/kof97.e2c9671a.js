var Module=null;!function(e){function t(){return Array.prototype.reduce.call(arguments,M)}function n(){var e=Array.prototype.reduce.call(arguments,M);return e.emulator_arguments=p(e.emulatorStart,e.files,e.extra_dosbox_args),e.runner=v,e}function o(){var e=Array.prototype.reduce.call(arguments,M);return e.emulator_arguments=p(e.emulatorStart,e.files,e.extra_dosbox_args),e.runner=y,e}function i(){var e=Array.prototype.reduce.call(arguments,M);return e.emulator_arguments=d(e.muted,e.mame_driver,e.nativeResolution,e.sample_rate,e.peripheral,e.autoboot,e.extra_mame_args,e.keep_aspect,e.scale),e.runner=w,e}function r(){var e=Array.prototype.reduce.call(arguments,M);return e.fliplist&&r._create_fliplist_file(e.files,e.fliplist),e.emulator_arguments=h(e.emulatorStart,e.files,e.fliplist,e.extra_vice_args),e.runner=v,e}function a(){var e=Array.prototype.reduce.call(arguments,M);return e.runner=S,e}function l(){var e=Array.prototype.reduce.call(arguments,M);return e.emulator_arguments=["-c","/emulator/pce-"+e.pceModel+".cfg"],e.extra_pce_args&&e.extra_pce_args.length>0&&(e.emulator_arguments=e.emulator_arguments.concat(e.extra_pce_args)),e.runner=v,e}function s(){var e=Array.prototype.reduce.call(arguments,M);return e.runner=F,e}function u(){var e=Array.prototype.reduce.call(arguments,M);if(!e.emulatorStart)throw new Error("You must specify an autoLoad value in order to start this emulator. Try the name of the disk image.");return e.emulator_arguments=_(e.emulatorStart,e.files,e.extra_np2_args),e.runner=b,e}function c(){var e=Array.prototype.reduce.call(arguments,M);if(!e.emulatorStart)throw new Error("You must specify an autoLoad value in order to start this emulator. Try the name of the disk image.");return e.emulator_arguments=g(e.emulatorStart,e.files,e.extra_np2_args),e.runner=b,e}function f(){var e=Array.prototype.reduce.call(arguments,M);return e.runner=x,e}function m(){var e=Array.prototype.reduce.call(arguments,M);return e.memory_size=e.memory_size||32,e.vga_memory_size=e.vga_memory_size||2,e.boot_order=e.boot_order||531,e.runner=E,e}t.canvas=function(e){return{canvas:e instanceof Element?e:document.getElementById(e)}},t.emulatorJS=function(e){return{emulatorJS:e}},t.emulatorWASM=function(e){return{emulatorWASM:e}},t.locateAdditionalEmulatorJS=function(e){return{locateAdditionalJS:e}},t.fileSystemKey=function(e){return{fileSystemKey:e}},t.nativeResolution=function(e,t){if("number"!=typeof e||"number"!=typeof t)throw new Error("Width and height must be numbers");return{nativeResolution:{width:Math.floor(e),height:Math.floor(t)}}},t.aspectRatio=function(e){if("number"!=typeof e)throw new Error("Aspect ratio must be a number");return{aspectRatio:e}},t.scale=function(e){return{scale:e}},t.sampleRate=function(e){return{sample_rate:e}},t.muted=function(e){return{muted:e}},t.mountZip=function(e,t){return{files:[{drive:e,mountpoint:"/"+e,file:t}]}},t.mountFile=function(e,t){return{files:[{mountpoint:e,file:t}]}},t.fetchFile=function(e,t){return{title:e,url:t,optional:!1}},t.fetchOptionalFile=function(e,t){return{title:e,url:t,optional:!0}},t.localFile=function(e,t){return{title:e,data:t}},n.__proto__=t,n.startExe=function(e){return{emulatorStart:e}},n.extraArgs=function(e){return{extra_dosbox_args:e}},n.mountZip=function(e,t,n){return{files:[{drive:e,mountpoint:"/"+e,file:t,drive_type:n||"hdd"}]}},o.__proto__=n,i.__proto__=t,i.driver=function(e){return{mame_driver:e}},i.peripheral=function(e,t){var n={};return n[e]=[t],{peripheral:n}},i.keepAspect=function(e){return{keep_aspect:!!e}},i.extraArgs=function(e){return{extra_mame_args:e}},i.autoboot=function(e){return{autoboot:e}},r.__proto__=t,r.autoLoad=function(e){return{emulatorStart:e}},r.extraArgs=function(e){return{extra_vice_args:e}},r.fliplist=function(e){return{fliplist:e}},r._create_fliplist_file=function(e,t){var n="# Vice fliplist file\n\n";t.forEach((function(e,t){e&&(e=e.reverse(),n+="UNIT "+(t+8).toString()+"\n",e.forEach((function(e){n+="/emulator/"+e+"\n"})))})),e.push(r.mountFile("/metadata_fliplist.vfl",r.localFile("Fliplist",n)).files[0])},a.__proto__=t,a.model=function(e){return{amigaModel:e}},a.fastMemory=function(e){return{fast_memory:e<<20}},a.rom=function(e){return"string"==typeof e&&(e=[e]),{rom:e[0],extRom:e[1]}},a.floppy=function(e,t){var n={};return n[e]=t,{floppy:n}},a.ntsc=function(e){return{ntsc:!!e}},l.__proto__=t,l.model=function(e){return{pceModel:e}},l.extraArgs=function(e){return{extra_pce_args:e}},s.__proto__=t,s.swf_file_name=function(e){return{swf_file_name:e}},u.__proto__=t,u.autoLoad=function(e){return{emulatorStart:e}},u.extraArgs=function(e){return{extra_np2_args:e}},c.__proto__=u,f.roms=function(e){"string"==typeof e&&(e=[e]);var t={};return t.bios=e.find((e=>e.match(/\.bin$/i))),t.session=e.find((e=>e.match(/\.img$/i))),t},f.prc=function(e){return{prc:e}},f.__proto__=t,m.__proto__=t,m.bios=function(e){return{bios:{path:e}}},m.vgaBios=function(e){return{vga_bios:{path:e}}},m.fda=function(e){return{fda:{path:e}}},m.fdb=function(e){return{fdb:{path:e}}},m.hda=function(e){return{hda:{path:e}}},m.hdb=function(e){return{hda:{path:e}}},m.cdrom=function(e){return{cdrom:{path:e}}},m.bootOrder=function(e){return{boot_order:e}},m.acpi=function(e){return{acpi:!!e}},m.memorySize=function(e){return{memory_size:e}},m.vgaMemorySize=function(e){return{vga_memory_size:e}};var d=function(e,t,n,o,i,r,a,l,s){s=s||1;var u=[t,"-verbose","-rompath","emulator","-window",l?"-keepaspect":"-nokeepaspect"];if(n&&"width"in n&&"height"in n&&u.push("-resolution",[n.width*s,n.height*s].join("x")),o&&u.push("-samplerate",o),r&&u.push("-autoboot_command",r+"\\n","-autoboot_delay","2"),a&&(u=u.concat(a)),i)for(var c in i)Object.prototype.propertyIsEnumerable.call(i,c)&&u.push("-"+c,"/emulator/"+i[c][0].replace(/\//g,"_"));return u},p=function(e,t,n){for(var o=["-conf","/emulator/dosbox.conf"],i=t.length,r=0;r<i;r++)"drive"in t[r]&&("hdd"===t[r].drive_type?o.push("-c","mount "+t[r].drive+" /emulator"+t[r].mountpoint):"floppy"===t[r].drive_type?o.push("-c","mount "+t[r].drive+" /emulator"+t[r].mountpoint+" -t floppy"):"cdrom"===t[r].drive_type&&o.push("-c","mount "+t[r].drive+" /emulator"+t[r].mountpoint+" -t cdrom"));n&&(o=o.concat(n));var a=e.split(/\\|\//);o.push("-c",/^[a-zA-Z]:$/.test(a[0])?a.shift():"c:");var l=a.pop();return a&&a.length&&o.push("-c","cd "+a.join("/")),o.push("-c",l),o},h=function(e,t,n,o){var i=e?["-autostart","/emulator/"+e]:[];return(n[0]||n[1]||n[2]||n[3])&&(i=i.concat(["-flipname","/emulator/metadata_fliplist.vfl"])),o&&(i=i.concat(o)),i},_=function(e,t,n){var o=e?[e]:[];return n&&(o=o.concat(n)),o},g=function(e,t,n){var o=t.map((e=>"/emulator"+e.mountpoint)).filter((t=>t!=e&&"/emulator/minivmac"!=t));return e&&o.unshift(e),n&&(o=o.concat(n)),o};function v(e,t){var n=this;this._canvas=e,this._hooks={start:[],reset:[]},Module={arguments:t.emulator_arguments,screenIsReadOnly:!0,print:function(e){console.log(e)},printErr:function(e){console.log(e)},canvas:e,noInitialRun:!1,locateFile:t.locateAdditionalJS,wasmBinary:t.wasmBinary,preInit:function(){BrowserFS.initialize(t.fs);var e=new BrowserFS.EmscriptenFS;FS.mkdir("/emulator"),FS.mount(e,{root:"/"},"/emulator")},preRun:[function(){n._hooks.start.forEach((function(e){e&&e()}))}]}}function y(){return v.apply(this,arguments)}function b(){return v.apply(this,arguments)}function w(){return v.apply(this,arguments)}function S(e,t){this._sae=new ScriptedAmigaEmulator,this._cfg=this._sae.getConfig(),this._canvas=e;var n=null;switch(t.amigaModel){case"A500":n=SAEC_Model_A500;break;case"A500P":n=SAEC_Model_A500P;break;case"A600":n=SAEC_Model_A600;break;case"A1000":n=SAEC_Model_A1000;break;case"A1200":n=SAEC_Model_A1200;break;case"A2000":n=SAEC_Model_A2000;break;case"A3000":n=SAEC_Model_A3000;break;case"A4000":n=SAEC_Model_A4000;break;case"A4000T":n=SAEC_Model_A4000T}this._sae.setModel(n,0),this._cfg.memory.z2FastSize=t.fastMemory||2097152,this._cfg.floppy.speed=SAEC_Config_Floppy_Speed_Turbo,this._cfg.video.id=e.getAttribute("id"),t.nativeResolution&&360==t.nativeResolution.height&&284==t.nativeResolution.width?(this._cfg.video.hresolution=SAEC_Config_Video_HResolution_LoRes,this._cfg.video.vresolution=SAEC_Config_Video_VResolution_NonDouble,this._cfg.video.size_win.width=SAEC_Video_DEF_AMIGA_WIDTH,this._cfg.video.size_win.height=SAEC_Video_DEF_AMIGA_HEIGHT):t.nativeResolution&&1440==t.nativeResolution.height&&568==t.nativeResolution.width?(this._cfg.video.hresolution=SAEC_Config_Video_HResolution_SuperHiRes,this._cfg.video.vresolution=SAEC_Config_Video_VResolution_Double,this._cfg.video.size_win.width=SAEC_Video_DEF_AMIGA_WIDTH<<2,this._cfg.video.size_win.height=SAEC_Video_DEF_AMIGA_HEIGHT<<1):(this._cfg.video.hresolution=SAEC_Config_Video_HResolution_HiRes,this._cfg.video.vresolution=SAEC_Config_Video_VResolution_Double,this._cfg.video.size_win.width=SAEC_Video_DEF_AMIGA_WIDTH<<1,this._cfg.video.size_win.height=SAEC_Video_DEF_AMIGA_HEIGHT<<1),this._cfg.memory.rom.name=t.rom,this._cfg.memory.rom.data=t.fs.readFileSync("/"+t.rom,null,k),this._cfg.memory.rom.size=this._cfg.memory.rom.data.length,t.extRom&&(this._cfg.memory.extRom.name=t.extRom,this._cfg.memory.extRom.data=t.fs.readFileSync("/"+t.extRom,null,k),this._cfg.memory.extRom.size=this._cfg.memory.extRom.data.length);for(var o=0;o<Object.keys(t.floppy).length;o++)this._cfg.floppy.drive[o].file.name=t.floppy[o],this._cfg.floppy.drive[o].file.data=t.fs.readFileSync("/"+t.floppy[o],null,k),this._cfg.floppy.drive[o].file.size=this._cfg.floppy.drive[o].file.data.length}function E(t,n){var o=document.createElement("div");o.id=t.id,o.classList=t.classList,o.style=t.style;var i=document.createElement("div");i.classList=["emularity-v86-screen-container"],i.style="display:flex;justify-content:center;align-items:center;background-color:#000;";var r=document.createElement("div");r.classList=["emularity-v86-screen-text"],r.style="font-size:14px;font-family:monospace;line-height:14px;white-space:pre;";var a=document.createElement("canvas");a.classList=["emularity-v86-screen-canvas"],a.style="display:none;",i.appendChild(r),i.appendChild(a),o.appendChild(i),t.parentNode.replaceChild(o,t);var l={};l.screen_container=i,l.memory_size=Math.floor(1048576*n.memory_size),l.vga_memory_size=Math.floor(1048576*n.vga_memory_size),l.acpi=n.acpi,l.boot_order=n.boot_order,l.autostart=!0,l.wasm_fn=t=>new e((async e=>{e((await WebAssembly.instantiate(n.wasmBinary,t)).instance.exports)})),["bios","vga_bios","fda","fdb","cdrom","hda","hdb"].forEach((e=>{n[e]&&n[e].path&&(l[e]={buffer:n.fs.readFileSync("/"+n[e].path,null,k).buffer})}));var s=new V86Starter(l);this._emulator=s,this.ready=null,n.scale&&s.screen_set_scale(n.scale,n.scale),i.addEventListener("click",(function(e){s.lock_mouse()}))}function F(e,t){if(!t.swf_file_name){let e=t.files[0].file.url;t.swf_file_name=e.slice(e.lastIndexOf("/"))}let n=t.fs.readFileSync(t.swf_file_name,null,k);this.ready=null;let o=RufflePlayer.newest().createPlayer();o.addEventListener("loadedmetadata",(()=>{o.style.width=o.metadata.width+"px",o.style.height=o.metadata.height+"px"})),this._player=o;for(let t of e.attributes)o.setAttribute(t.localName,t.nodeValue);e.parentElement.replaceChild(o,e),o.load({data:n,swfFileName:t.swf_file_name.replace("/",""),splashScreen:!1}).then((()=>{this.ready()}))}function x(e,t){t.bios&&(this._biosFile=t.fs.readFileSync("/"+t.bios,null,k)),t.session&&(this._sessionFile=t.fs.readFileSync("/"+t.session,null,k)),t.prc&&(t.prc.match(/\.zip$/i)?(this._prcZip=t.fs.readFileSync("/"+t.prc,null,k),this._prcFileName=t.prc.replace(/\.zip$/i,".prc")):this._prcFile=t.fs.readFileSync("/"+t.prc,null,k)),this._canvas=e}function A(t,n,o){"object"!=typeof n&&(n={before_emulator:null,before_run:n});var i,r,a,l,s=!1,u={foreground:"white",background:"black",failure:"red"},c={loading_text:"",spinning:!0,finished_loading:!1,colors:u,table:null,splashimg:new Image},f=!1;if(this.isMuted=function(){return f},this.mute=function(){return this.setMute(!0)},this.unmute=function(){return this.setMute(!1)},this.toggleMute=function(){return this.setMute(!f)},this.setMute=function(e){if(f=e,i)e?i.mute():i.unmute();else try{r||(r=Module.cwrap("SDL_PauseAudio","",["number"])),r(e)}catch(e){console.log("Unable to change audio state:",e)}return this},window.addEventListener("gamepadconnected",(function(e){console.log("Gamepad connected at index %d: %s. %d buttons, %d axes.",e.gamepad.index,e.gamepad.id,e.gamepad.buttons.length,e.gamepad.axes.length)})),window.addEventListener("gamepaddisconnected",(function(e){console.log("Gamepad disconnected from index %d: %s",e.gamepad.index,e.gamepad.id)})),!t.hasAttribute("width")){var m=getComputedStyle(t);t.width=parseInt(m.width,10),t.height=parseInt(m.height,10)}this.setScale=function(e){return console.warn("setScale method is deprecated; use the BaseLoader.scale method instead"),this},this.setSplashImage=function(e){return e&&(e instanceof Image?c.splashimg.parentNode?c.splashimg.src=e.src:c.splashimg=e:c.splashimg.src=e),this},this.setCSSResolution=function(e){return a=e,this},this.setAspectRatio=function(e){return l=e,this},this.setCallbacks=function(e){return n="object"!=typeof e?{before_emulator:null,before_run:e}:e,this},this.setSplashColors=function(e){return c.colors=e,this},this.setLoad=function(e){return o=e,this};this.start=function(r){if(s)return!1;s=!0;var u,m,d,_={waitAfterDownloading:!1,hasCustomCSS:!1};function y(){var e=new d.runner(t,d);return g(t,d.scale,d.nativeResolution,d.aspectRatio),e.onStarted((function(){c.finished_loading=!0,c.hide(),setTimeout((function(){f&&e.mute(),n&&n.before_run&&n.before_run()}),0)})),e.onReset((function(){f&&e.mute()})),e}return"object"!=typeof r?r=_:r.__proto__=_,function(e,t,n){t.splashElt=document.getElementById("emularity-splash-screen"),t.splashElt||(t.splashElt=document.createElement("div"),t.splashElt.classList.add("emularity-splash-screen"),n.hasCustomCSS||(t.splashElt.style.position="absolute",t.splashElt.style.top="0",t.splashElt.style.left="0",t.splashElt.style.right="0",t.splashElt.style.color=t.getColor("foreground"),t.splashElt.style.backgroundColor=t.getColor("background")),e.parentElement.appendChild(t.splashElt));t.splashimg.classList.add("emularity-splash-image"),n.hasCustomCSS||(t.splashimg.style.display="block",t.splashimg.style.marginLeft="auto",t.splashimg.style.marginRight="auto");t.splashElt.appendChild(t.splashimg),t.titleElt=document.createElement("span"),t.titleElt.classList.add("emularity-splash-title"),n.hasCustomCSS||(t.titleElt.style.display="block",t.titleElt.style.width="100%",t.titleElt.style.marginTop="1em",t.titleElt.style.marginBottom="1em",t.titleElt.style.textAlign="center",t.titleElt.style.font="24px sans-serif");t.titleElt.textContent=" ",t.splashElt.appendChild(t.titleElt);var o=document.getElementById("emularity-progress-indicator");o||((o=document.createElement("table")).classList.add("emularity-progress-indicator"),o.dataset.hasCustomCSS=n.hasCustomCSS,n.hasCustomCSS||(o.style.width="75%",o.style.color=t.getColor("foreground"),o.style.backgroundColor=t.getColor("background"),o.style.marginLeft="auto",o.style.marginRight="auto",o.style.borderCollapse="separate",o.style.borderSpacing="2px"),t.splashElt.appendChild(o));t.table=o}(t,c,r),b(),("function"==typeof o?o(p,c):e.resolve(o)).then((function(t){return new e((function(n,o){function i(i,r){d=t;var a=BrowserFS.FileSystem.MountableFileSystem,l=BrowserFS.FileSystem.OverlayFS,s=BrowserFS.FileSystem.ZipFS,u=BrowserFS.BFSRequire("buffer").Buffer;a.Create((function(t,i){l.Create({readable:i,writable:r},(function(t,a){if(t)console.error("Failed to initialize the OverlayFS:",t),o();else{function l(e){var t="cached"in e&&e.cached,n="data"in e&&null!==e.data&&void 0!==e.data;return t||n?h(e.title,e.data):p(e.title,e.url,"arraybuffer",e.optional)}d.fs=a;var c=d.files.map((function(t){if(t&&t.file){if(t.drive)return l(t.file).then((a=t.drive,function(t){if(null!==t){var n="/"+(a=a.toLowerCase());return new e((function(e,o){return new s.Create({zipData:new u(t)},(function(t,r){t?o():(i.mount(n,r),e())}))}))}}));if(t.mountpoint){var n="/"!=t.mountpoint[0]?"/"+t.mountpoint:t.mountpoint;return t.file.cached=r.existsSync(n),l(t.file).then((o=n,function(e){if(null!==e){if(r.existsSync(o))return;if(o.includes("/",1))for(var t=o.substring(1).split("/"),n=1;n<t.length;n++){var i="/"+t.slice(0,n).join("/");r.existsSync(i)||r.mkdirSync(i,511)}r.writeFileSync(o,new u(e),null,L,420)}}))}}var o,a;return null}));"emulatorWASM"in d&&d.emulatorWASM&&"WebAssembly"in window&&c.push(l({title:"WASM Binary",url:d.emulatorWASM}).then((function(e){d.wasmBinary=e}))),e.all(c).then(n,o)}}))}))}BrowserFS.FileSystem.InMemory.Create((function(e,n){if(BrowserFS.FileSystem.IndexedDB.isAvailable()){var o=BrowserFS.FileSystem.AsyncMirror,r=BrowserFS.FileSystem.IndexedDB,a="fileSystemKey"in t?t.fileSystemKey:"emularity";r.Create({storeName:a},(function(e,t){e?i(e,n):o.Create({sync:n,async:t},i)}))}else i(e,n)}))}))})).then((function(n){return!d||c.failed_loading?null:r.waitAfterDownloading?new e((function(e,n){c.setTitle("Press any key to continue..."),c.spinning=!1,window.addEventListener("keypress",u=function(e){return function(t){32==t.which&&(t.preventDefault(),e())}}(e)),t.addEventListener("click",m=e),c.splashElt.addEventListener("click",m)})):e.resolve()}),(function(){c.failed_loading||(c.setTitle("Failed to download game data!"),c.failed_loading=!0)})).then((function(){if(!d||c.failed_loading)return null;var o;if(c.spinning=!0,window.removeEventListener("keypress",u),t.removeEventListener("click",m),c.splashElt.removeEventListener("click",m),function(){function e(e){return!(e.which>=33&&e.which<=40)||(e.preventDefault(),!1)}window.onkeydown=e}(),o=function(){document.mozFullScreenElement||document.fullScreenElement||g(t,scale,a,l)},"onfullscreenchange"in document?document.addEventListener("fullscreenchange",o):"onmozfullscreenchange"in document?document.addEventListener("mozfullscreenchange",o):"onwebkitfullscreenchange"in document&&document.addEventListener("webkitfullscreenchange",o),t.addEventListener("contextmenu",(function(e){2==e.button&&e.preventDefault()})),t.requestPointerLock=t.requestPointerLock||t.mozRequestPointerLock||t.webkitRequestPointerLock,function(e){var t=null;function n(o){e.readdirSync(o).forEach((function(i){if(!t&&"."!==i&&".."!==i){var r=o+("/"!==o[o.length-1]?"/":"")+i,a=e.statSync(r);a.isDirectory(a.mode)?n(r):"dosbox.conf"===i&&(t=r)}}))}n("/"),null!==t&&e.writeFileSync("/dosbox.conf",e.readFileSync(t,null,k),null,L,420)}(d.fs),n&&n.before_emulator)try{n.before_emulator()}catch(e){console.log(e)}return"runner"in d&&(d.runner==v||d.runner.prototype instanceof v)&&(i=y()),d.emulatorJS?(c.setTitle("Launching Emulator"),function(t){return new e((function(e,n){var o;function i(t){t.target==o&&(o.removeEventListener("load",i),o.removeEventListener("error",r),e())}function r(e){e.target==o&&(o.removeEventListener("load",i),o.removeEventListener("error",r),n())}if(t){var a=document.getElementsByTagName("head")[0];(o=document.createElement("script")).addEventListener("load",i),o.addEventListener("error",r),o.type="text/javascript",o.src=t,a.appendChild(o)}}))}(d.emulatorJS)):(c.setTitle("Non-system disk or disk error"),null)}),(function(){if(!d||c.failed_loading)return null;c.setTitle("Invalid media, track 0 bad or unusable"),c.failed_loading=!0})).then((function(){if(!d||c.failed_loading)return null;"runner"in d&&(i||(i=y()),i.start())})),this};var d=function(e,t){if(0===e)return"0 B";var n=t?1e3:1024,o=t?["B","kB","MB","GB","TB","PB","EB","ZB","YB"]:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],i=parseInt(Math.log(e)/Math.log(n));return(e/Math.pow(n,i)).toFixed(1)+" "+o[i]},p=function(e,t,n,o){return _(e,t,n,o,!1)},h=function(e,t){return _(e,t,null,!1,!0)},_=function(t,n,o,i,r){var a="false"==c.table.dataset.hasCustomCSS,l=y(c.table),s=l[0],u=l[1];return s.textContent=t,new e((function(e,a){if(r)f(),e(n);else{var l=new XMLHttpRequest;l.open("GET",n,!0),l.responseType=o||"arraybuffer",l.onprogress=function(e){var n;s.innerHTML=t+' <span style="font-size: smaller">'+(((n=e).lengthComputable?"("+(n.total?(n.loaded/n.total*100).toFixed(0):"100")+"%; "+d(n.loaded)+" of "+d(n.total)+")":"("+d(n.loaded)+")")+"</span>")},l.onload=function(t){200===l.status?(f(),e(l.response)):i?(f(),e(null)):(m(),a())},l.onerror=function(t){i?(f(),e(null)):(m(),a())},l.send()}}));function f(){u.textContent="✔",s.parentNode.classList.add("emularity-download-success"),s.textContent=t,a&&(s.style.fontWeight="bold",s.parentNode.style.backgroundColor=c.getColor("foreground"),s.parentNode.style.color=c.getColor("background"))}function m(){u.textContent="✘",s.parentNode.classList.add("emularity-download-failure"),s.textContent=t,a&&(s.style.fontWeight="bold",s.parentNode.style.backgroundColor=c.getColor("failure"),s.parentNode.style.color=c.getColor("background"))}};var g=function(e,t,n,o){t&&n&&(e.style.imageRendering="-moz-crisp-edges",e.style.imageRendering="-o-crisp-edges",e.style.imageRendering="-webkit-optimize-contrast",e.style.imageRendering="optimize-contrast",e.style.imageRendering="crisp-edges",e.style.imageRendering="pixelated",e.style.imageRendering="optimizeSpeed",e.style.width=n.width*t+"px",e.style.height=n.height*t+"px",e.setAttribute("width",n.width*t),e.setAttribute("height",n.height*t))};c.setTitle=function(e){c.titleElt.textContent=e},c.hide=function(){c.splashElt.style.display="none"},c.getColor=function(e){return e in c.colors?c.colors[e]:u[e]};var y=function(e){var t="false"==e.dataset.hasCustomCSS,n=e.insertRow(-1);t&&(n.style.textAlign="center");var o=n.insertCell(-1);t&&(o.style.position="relative");var i=document.createElement("span");i.classList.add("emularity-download-title"),i.textContent="—",t&&(i.style.verticalAlign="center",i.style.minHeight="24px",i.style.whiteSpace="nowrap"),o.appendChild(i);var r=document.createElement("span");return r.classList.add("emularity-download-status"),t&&(r.style.position="absolute",r.style.left="0",r.style.paddingLeft="0.5em"),o.appendChild(r),[i,r]},b=function(){t.setAttribute("moz-opaque",""),c.splashimg.src||(c.splashimg.src="logo/emularity_color_small.png")};this.isfullscreensupported=function(){return!!C()},this.requestFullScreen=function(){i&&i.requestFullScreen()}}function C(){return canvas.requestFullScreen||canvas.webkitRequestFullScreen||canvas.mozRequestFullScreen}v.prototype.start=function(){},v.prototype.pause=function(){},v.prototype.stop=function(){},v.prototype.mute=function(){try{SDL_PauseAudio||(SDL_PauseAudio=Module.cwrap("SDL_PauseAudio","",["number"])),SDL_PauseAudio(!0)}catch(e){console.log("Unable to change audio state:",e)}},v.prototype.unmute=function(){try{SDL_PauseAudio||(SDL_PauseAudio=Module.cwrap("SDL_PauseAudio","",["number"])),SDL_PauseAudio(!1)}catch(e){console.log("Unable to change audio state:",e)}},v.prototype.onStarted=function(e){this._hooks.start.push(e)},v.prototype.onReset=function(e){this._hooks.reset.push(e)},v.prototype.requestFullScreen=function(){this._canvas.requestFullscreen()},y.prototype=Object.create(v.prototype),y.prototype.start=function(){FS.symlink("/emulator/y/FONT.ROM","/FONT.ROM"),FS.symlink("/emulator/y/2608_bd.wav","/2608_bd.wav"),FS.symlink("/emulator/y/2608_hh.wav","/2608_hh.wav"),FS.symlink("/emulator/y/2608_sd.wav","/2608_sd.wav"),FS.symlink("/emulator/y/2608_rim.wav","/2608_rim.wav"),FS.symlink("/emulator/y/2608_tom.wav","/2608_tom.wav"),FS.symlink("/emulator/y/2608_top.wav","/2608_top.wav")},b.prototype=Object.create(v.prototype),b.prototype.start=function(){try{var e=FS.readFile("/emulator/np2.cfg");FS.writeFile("/emulator/np2/np2.cfg",e)}catch(e){console.log(e)}},w.prototype=Object.create(v.prototype,{mute:{value:function(){var e=Module.__ZN15running_machine30emscripten_get_running_machineEv(),t=Module.__ZN15running_machine20emscripten_get_soundEv(e);Module.__ZN13sound_manager4muteEbh(t,!0,2)}},unmute:{value:function(){var e=Module.__ZN15running_machine30emscripten_get_running_machineEv(),t=Module.__ZN15running_machine20emscripten_get_soundEv(e);Module.__ZN13sound_manager4muteEbh(t,!1,2)}}}),S.prototype.start=function(){this._sae.start()},S.prototype.pause=function(){this._sae.pause()},S.prototype.stop=function(){this._sae.stop()},S.prototype.mute=function(){var e=this._sae.mute(!0);e&&console.warn("unable to mute; SAE error number",e)},S.prototype.unmute=function(){var e=this._sae.mute(!1);e&&console.warn("unable to unmute; SAE error number",e)},S.prototype.onStarted=function(e){this._cfg.hook.event.started=e},S.prototype.onReset=function(e){this._cfg.hook.event.reseted=e},S.prototype.requestFullScreen=function(){C().call(this._canvas)},E.prototype.start=function(){this._emulator.run()},E.prototype.pause=function(){this._emulator.stop()},E.prototype.stop=function(){this._emulator.stop()},E.prototype.mute=function(){this._emulator.is_muted&&(this._emulator.speaker_adapter.mixer.set_volume(1,void 0),this._emulator.is_muted=!1)},E.prototype.unmute=function(){this._emulator.is_muted||(this._emulator.speaker_adapter.mixer.set_volume(0,void 0),this._emulator.is_muted=!0)},E.prototype.onStarted=function(e){this._emulator.add_listener("emulator-started",e)},E.prototype.onReset=function(e){},E.prototype.requestFullScreen=function(){C().call(this._canvas)},F.prototype.requestFullScreen=function(){this._player.enterFullscreen()},F.prototype.onReset=function(e){},F.prototype.start=function(e){},F.prototype.onStarted=function(e){this.ready=e},F.prototype.mute=function(){this._player.volume=0},F.prototype.unmute=function(){this._player.volume=1},x.prototype.onReset=function(e){},x.prototype.start=function(e){var t=this;cloudpilot.createEmulator().then((function(e){e.setCanvas(t._canvas).bindInput(t._canvas,t._canvas),t._sessionFile&&t._prcFile?e.loadSession(t._sessionFile).installAndLaunchDatabase(t._prcFile):t._sessionFile&&t._prcZip?e.loadSession(t._sessionFile).installFromZipfileAndLaunch(t._prcZip,t._prcFileName):t._biosFile&&e.loadRom(t._biosFile),e.resume(),t._canvas.tabIndex=0,t._canvas.style.outline=0,t._canvas.focus(),t._emulator=e}))},x.prototype.onStarted=function(e){e()},x.prototype.mute=function(){this._emulator&&this._emulator.setVolume(0)},x.prototype.unmute=function(){this._emulator&&(this._emulator.isAudioInitialized()||this._emulator.initializeAudio(),this._emulator.setVolume(1))},x.prototype.requestFullScreen=function(){C().call(this._canvas)};var k={isReadable:function(){return!0},isWriteable:function(){return!1},isTruncating:function(){return!1},isAppendable:function(){return!1},isSynchronous:function(){return!1},isExclusive:function(){return!1},pathExistsAction:function(){return 0},pathNotExistsAction:function(){return 1}},L={isReadable:function(){return!1},isWriteable:function(){return!0},isTruncating:function(){return!1},isAppendable:function(){return!1},isSynchronous:function(){return!1},isExclusive:function(){return!1},pathExistsAction:function(){return 0},pathNotExistsAction:function(){return 3}};function M(e,t){if(null===e)return t;if(null===t)return e;var n=typeof e,o=typeof t;if(n!==o){if("undefined"===n)return t;if("undefined"===o)return e;throw new Error("Cannot extend an "+n+" with an "+o)}return Array.isArray(e)?e.concat(t):"object"===n?(Object.keys(t).forEach((function(n){e[n]=M(n in e?e[n]:void 0,t[n])})),e):t}function R(e){e instanceof XMLDocument&&(e=e.documentElement);var t,n={},o=e.childNodes.length;for(t=0;t<o;t++){var i=e.childNodes[t];n[i.nodeName]=i.textContent}return n}function B(e){return function(e){return e instanceof XMLDocument&&(e=e.documentElement),Array.prototype.slice.call(e.childNodes)}(e).filter((function(e){return"getAttribute"in e})).map((function(e){var t=R(e);return t.name=e.getAttribute("name"),t}))}function z(e,t){return t?(t.startsWith(".")||(t="."+t),t=t.toLowerCase(),B(e).filter((function(e){return e.name.toLowerCase().endsWith(t)}))):[]}function O(e,t){return"string"==typeof t&&(t=RegExp(t)),Object.keys(e).map((function(e){var n=t.exec(e);return n?[e,n]:null})).filter((function(e){return!!e}))}window.IALoader=function(t,o,d,p){if("string"!=typeof o&&(o=o.toString()),d&&"object"==typeof d)if("function"==typeof d.before_emulator){var h=d.before_emulator;d.before_emulator=function(){v(),h()}}else d.before_emulator=v;else d={before_emulator:v,before_run:d};function _(e){var t=new Image;return t.src=e,t}var g;function v(){x&&L.setSplashImage(x)}g=/archive\.org$/.test(document.location.hostname)?{ia:_("/images/ialogo.png"),mame:_("/images/mame.png"),mess:_("/images/mame.png"),dosbox:_("/images/dosbox.png"),sae:_("/images/sae.png"),pce:_("/images/pce.png"),vice:_("/images/vice.svg"),np2:_("/images/nekop2.gif"),xmil:_("/images/xmillenium_logo.jpg"),vmac:_("/images/vmac.png"),ruffle:_("/images/ruffle.png"),cloudpilot:_("/images/cloudpilot.png"),v86:_("/images/v86.png")}:{ia:_("other_logos/ia-logo-150x150.png"),mame:_("other_logos/mame.png"),mess:_("other_logos/mame.png"),dosbox:_("other_logos/dosbox.png"),sae:_("other_logos/sae.png"),pce:_("other_logos/pce.png"),vice:_("other_logos/vice.svg"),np2:_("other_logos/nekop2.gif"),xmil:_("other_logos/xmillenium_logo.jpg"),vmac:_("other_logos/vmac.png"),ruffle:_("other_logos/ruffle.png"),cloudpilot:_("other_logos/cloudpilot.png"),v86:_("other_logos/v86.png")};var y,b,w,S,E,F,x,C,k=!!(y=window.AudioContext||window.webkitAudioContext||!1)&&(new y).sampleRate.toString(),L=new A(t).setSplashImage(g.ia).setLoad((function(t,d){return d.setTitle("Downloading game metadata..."),new e((function(h,_){t("Game Metadata",K(o),"document").then((function(e){return b=e,d.setTitle("Downloading game filelist..."),t("Game File List",Y(o),"document",!0)}),(function(){d.setTitle("Failed to download IA item metadata!"),d.failed_loading=!0,_(1)})).then((function(e){return d.failed_loading?null:(w=e,d.setTitle("Downloading emulator metadata..."),S=b.getElementsByTagName("emulator").item(0).textContent,t("Emulator Metadata",$(S),"text",!0))}),(function(){d.failed_loading||(d.setTitle("Failed to download file list!"),d.failed_loading=!0,_(2))})).then((function(t){if(d.failed_loading)return null;var h;if(E=JSON.parse(t),S&&0===S.indexOf("dosbox"))x=g.dosbox,C=n,h=D;else if(S&&0===S.indexOf("sae-"))x=g.sae,C=a,h=N;else if(S&&0===S.indexOf("pce-"))x=g.pce,C=l,h=G;else if(S&&0===S.indexOf("vice"))x=g.vice,C=r,h=I;else if(S&&0===S.indexOf("np2-"))x=g.np2,C=u,h=j;else if(S&&0===S.indexOf("ruffle-"))x=g.ruffle,C=s,h=P;else if(S&&0===S.indexOf("xmil-"))x=g.xmil,C=u,h=W;else if(S&&0===S.indexOf("vmac-"))x=g.vmac,C=c,h=Z;else if(S&&0===S.indexOf("cloudpilot-"))x=g.cloudpilot,C=f,h=V;else if(S&&0===S.indexOf("v86"))x=g.v86,C=m,h=H;else{if(!S)throw new Error("Unknown module type "+S+"; cannot configure the emulator.");x=g.mame,C=i,h=T}var _=E.wasm_filename&&"WebAssembly"in window,v=E.native_resolution;F=[C.emulatorJS(Q(_?E.wasmjs_filename:E.js_filename)),C.emulatorWASM(_&&Q(E.wasm_filename)),C.locateAdditionalEmulatorJS(B),C.fileSystemKey(o),C.nativeResolution(v[0],v[1]),C.aspectRatio(v[0]/v[1]),C.scale(p||E.scale||2),C.sampleRate(k)],"keepAspect"in C&&F.push(C.keepAspect(E.keepAspect)),/archive\.org$/.test(document.location.hostname)&&F.push(C.muted(document.cookie.indexOf("unmute=1")<0));var y=b.getElementsByTagName("emulator_start").item(0);if(S&&0===S.indexOf("dosbox"))F.push(C.startExe(b.getElementsByTagName("emulator_start").item(0).textContent));else if(S&&0===S.indexOf("vice")){var A=[b.getElementsByTagName("vice_drive_8_fliplist").item(0),b.getElementsByTagName("vice_drive_9_fliplist").item(0),b.getElementsByTagName("vice_drive_10_fliplist").item(0),b.getElementsByTagName("vice_drive_11_fliplist").item(0)];y&&F.push(C.autoLoad(y.textContent));var L=[];A.forEach((function(e){e?L.push(e.textContent.split(";")):L.push(null)})),F.push(C.fliplist(L)),F.push(C.extraArgs(E.extra_args))}else if(S&&0===S.indexOf("sae-"))F.push(C.model(E.driver),C.rom(E.bios_filenames));else if(!S||0!=S.indexOf("np2-")&&0!=S.indexOf("xmil-")&&0!=S.indexOf("vmac-"))S&&0===S.indexOf("pce-")?F.push(C.model(E.driver),C.extraArgs(E.extra_args)):S&&0===S.indexOf("cloudpilot-")?F.push(C.roms(E.bios_filenames)):S&&0===S.indexOf("ruffle-")?(E.config=E.config||{},E.config.base=J(o)):S&&0===S.indexOf("v86")?F.push(C.memorySize(E.memory_size),C.vgaMemorySize(E.vga_memory_size),C.acpi(E.acpi),C.bootOrder(E.boot_order)):S&&(F.push(C.driver(E.driver),C.extraArgs(E.extra_args)),y&&F.push(C.autoboot(y.textContent)));else{if(!y)throw new Exception("Error: this item does not have an 'emulator_start' metadata value; I don't know what to run.");F.push(C.autoLoad("/emulator/"+y.textContent),C.extraArgs(E.extra_args))}return d.setTitle("Downloading game data..."),e.all(h(C,b,E,w))}),(function(){d.failed_loading||(d.setTitle("Failed to download emulator metadata!"),d.failed_loading=!0,_(2))})).then((function(e){d.failed_loading||(v(),h(C.apply(null,M(F,e))))}),(function(e){d.failed_loading||(d.setTitle("Failed to configure emulator!"),d.failed_loading=!0,_(3))}))}))})).setCallbacks(d);function B(e){return"file_locations"in E&&e in E.file_locations?Q(E.file_locations[e]):Q(e)}function D(e,t,n,i){var r={},a=[],l=R(t);o&&o.endsWith(".zip")&&(r.c=o),z(i,l.emulator_ext).forEach((function(e,t){r.c=e.name})),O(l,/^dosbox_drive_([a-zA-Z])$/).forEach((function(e){var t=e[0],n=e[1];r[n[1]]=l[t]}));var s=Object.keys(r),u=s.length;return s.forEach((function(t,n){var i="Game File ("+(n+1)+" of "+u+")",l=r[t],s=l.includes("/")?X(l):X(l,q(o));l.toLowerCase().endsWith(".zip")?a.push(e.mountZip(t,e.fetchFile(i,s))):a.push(e.mountFile("/"+l,e.fetchFile(i,s)))})),a}function I(e,t,n,i){var r={},a=[],l=[],s=R(t);z(i,s.emulator_ext).forEach((function(e,t){l.push(e.name)})),z(i,"conf").forEach((function(e,t){l.push(e.name)})),O(s,/^vice_drive_([89])$/).forEach((function(e){var t=e[0],n=e[1];r[n[1]]=s[t]}));var u=l.length;return l.forEach((function(t,n){var i="Game File ("+(n+1)+" of "+u+")",r=t,l=r.includes("/")?X(r):X(r,q(o));r.toLowerCase().endsWith(".zip"),a.push(e.mountFile("/"+r,e.fetchFile(i,l)))})),a}function T(e,t,n,i){var r=[],a=n.bios_filenames,l=[];a.forEach((function(t,n){if(t){var o="Bios File ("+(n+1)+" of "+a.length+")",i=ee(t);r.push(e.mountFile("/"+t,e.fetchFile(o,i))),l.push(i)}}));var s=R(t),u={},c={};z(i,s.emulator_ext).forEach((function(e,t){c[e.name]=1,n.peripherals&&n.peripherals[t]&&(u[n.peripherals[t]]=e.name)})),O(s,/^mame_peripheral_([a-zA-Z0-9]+)$/).forEach((function(e){var t=e[0],n=e[1];u[n[1]]=s[t],c[s[t]]=1}));var f=Object.keys(c),m=f.length;f.forEach((function(t,n){var i="Game File ("+(n+1)+" of "+m+")",a=t.includes("/")?X(t):X(t,q(o));r.push(e.mountFile("/"+t,e.fetchFile(i,a))),l.push(a)}));var d=z(i,"chd");return m=d.length,d.forEach((function(t,i){var a="Game Drive ("+(i+1)+" of "+m+")",s=t.name.includes("/")?X(t.name):X(t.name,q(o));l.includes(s)||r.push(e.mountFile(n.driver+"/"+t.name,e.fetchFile(a,s)))})),Object.keys(u).forEach((function(t){r.push(e.peripheral(t,u[t]))})),r.push(e.mountFile("/"+n.driver+".cfg",e.fetchOptionalFile("CFG File",U(S)))),r}function N(e,t,n,i){var r=[],a=n.bios_filenames;a.forEach((function(t,n){if(t){var o="Bios File ("+(n+1)+" of "+a.length+")";r.push(e.mountFile("/"+t,e.fetchFile(o,ee(t))))}}));var l=z(i,R(t).emulator_ext);return l.forEach((function(t,n){if(t){var i="Game File ("+(n+1)+" of "+l.length+")",a=t.name.includes("/")?X(t.name):X(t.name,q(o));r.push(e.mountFile("/"+t.name,e.fetchFile(i,a))),r.push(e.floppy(0,t.name))}})),r.push(e.mountFile("/"+n.driver+".cfg",e.fetchOptionalFile("Config File",U(S)))),r}function P(e,t,n,i){window.RufflePlayer=window.RufflePlayer||{},window.RufflePlayer.config=n.config;var r=[],a=z(i,R(t).emulator_ext);if(a.length>0){var l=a[0],s=l.name.includes("/")?X(l.name):X(l.name,q(o));r.push(e.mountFile("/"+l.name,e.fetchFile("Downloading Game File",s))),r.push(e.swf_file_name("/"+l.name))}return r}function G(e,t,n,i){var r=[],a=n.bios_filenames;a.forEach((function(t,n){if(t){var o="ROM File ("+(n+1)+" of "+a.length+")";r.push(e.mountFile("/"+t,e.fetchFile(o,ee(t))))}}));var l=R(t),s={};z(i,l.emulator_ext).forEach((function(e,t){n.peripherals&&n.peripherals[t]&&(s[e.name]=n.peripherals[t])})),O(l,/^pce_drive_([a-zA-Z0-9]+)$/).forEach((function(e){var t=e[0],n=e[1][1];s[l[t]]=n}));var u=Object.keys(s),c=u.length;return u.forEach((function(t,n){var i="Game File ("+(n+1)+" of "+c+")",a=t.match(/\.([^.]*)$/)[1],l=t.includes("/")?X(t):X(t,q(o));r.push(e.mountFile("/"+s[t]+"."+a,e.fetchFile(i,l)))})),r.push(e.mountFile("/pce-"+n.driver+".cfg",e.fetchOptionalFile("Config File",U("pce-"+n.driver)))),r}function j(e,t,n,i){var r=[],a=n.bios_filenames;a.forEach((function(t,n){if(t){var o="ROM File ("+(n+1)+" of "+a.length+")",i=t.endsWith(".zip")?e.mountZip:e.mountFile;r.push(i("np2",e.fetchFile(o,ee(t))))}}));var l=R(t),s={};z(i,l.emulator_ext).forEach((function(e,t){s[e.name]=1}));var u=Object.keys(s),c=u.length;return u.forEach((function(t,n){var i="Game File ("+(n+1)+" of "+c+")",a=t.includes("/")?X(t):X(t,q(o));r.push(e.mountFile("/"+t,e.fetchFile(i,a)))})),r}function W(e,t,n,i){var r=[],a=n.bios_filenames;a.forEach((function(t,n){if(t){var o="ROM File ("+(n+1)+" of "+a.length+")",i=t.endsWith(".zip")?e.mountZip:e.mountFile;r.push(i("xmil",e.fetchFile(o,ee(t))))}}));var l=R(t),s={};z(i,l.emulator_ext).forEach((function(e,t){s[e.name]=1}));var u=Object.keys(s),c=u.length;return u.forEach((function(t,n){var i="Game File ("+(n+1)+" of "+c+")",a=t.includes("/")?X(t):X(t,q(o));r.push(e.mountFile("/"+t,e.fetchFile(i,a)))})),r}function Z(e,t,n,i){var r=[],a=n.bios_filenames;a.forEach((function(t,n){if(t){var o="ROM File ("+(n+1)+" of "+a.length+")",i=t.endsWith(".zip")?e.mountZip:e.mountFile;r.push(i("minivmac",e.fetchFile(o,ee(t))))}}));var l=R(t),s={};z(i,l.emulator_ext).forEach((function(e,t){s[e.name]=1})),O(l,/^vmac_drive_([0-9]+)$/).forEach((function(e){var t=e[0],n=e[1][1];s[l[t]]=n}));var u=Object.keys(s),c=u.length;return u.forEach((function(t,n){var i="Disk Image ("+(n+1)+" of "+c+")",a=t.includes("/")?X(t):X(t,q(o));r.push(e.mountFile("/"+t,e.fetchFile(i,a)))})),r}function V(e,t,n,i){var r=[];bios_files=n.bios_filenames,bios_files.forEach((function(t,n){if(t){var o="Bios File ("+(n+1)+" of "+bios_files.length+")";r.push(e.mountFile("/"+t,e.fetchFile(o,ee(t))))}}));var a=z(i,R(t).emulator_ext);a.length;if(a.length>0){var l=a[0],s=l.name.includes("/")?X(l.name):X(l.name,q(o));r.push(e.mountFile("/"+l.name,e.fetchFile("Downloading Game File",s))),r.push(e.prc(l.name))}return r}function H(e,t,n,i){var r=[];n.bios_filename&&(r.push(e.mountFile("/"+n.bios_filename,e.fetchFile("BIOS File",ee(n.bios_filename)))),r.push(e.bios(n.bios_filename))),n.vga_bios_filename&&(r.push(e.mountFile("/"+n.vga_bios_filename,e.fetchFile("VGA BIOS File",ee(n.vga_bios_filename)))),r.push(e.vgaBios(n.vga_bios_filename)));var a=R(t),l={};z(i,a.emulator_ext).forEach((function(e,t){n.peripherals&&n.peripherals[t]&&(l[e.name]=n.peripherals[t])})),O(a,/^v86_drive_([a-zA-Z0-9]+)$/).forEach((function(e){var t=e[0],n=e[1][1];l[a[t]]=n}));var s=Object.keys(l),u=s.length;return s.forEach((function(t,n){var i="Game File ("+(n+1)+" of "+u+")",a=t.match(/\.([^.]*)$/)[1],s=t.includes("/")?X(t):X(t,q(o)),c=l[t],f="/"+c+"."+a,m={};m[c]={path:f},r.push(e.mountFile(f,e.fetchFile(i,s))),r.push(m)})),r}var q=function(e){return e.split("/").shift()},J=function(e,t){return"//cors.archive.org/cors/"+e+(t?"/"+t:"")},$=function(e){return J("emularity_engine_v1",e+".json")},U=function(e){return J("emularity_config_v1",e+".cfg")},K=function(e){var t=e.split("/");return J(t[0],t[0]+"_meta.xml")},Y=function(e){var t=e.split("/");return J(t[0],t[0]+"_files.xml")},X=function(e,t){return t?J(t,e):J(e)},Q=function(e){return J("emularity_engine_v1",e)},ee=function(e){return J("emularity_bios_v1",e)};return L},window.DosBoxLoader=n,window.PC98DosBoxLoader=o,window.JSMESSLoader=i,window.JSMAMELoader=i,window.MAMELoader=i,window.SAELoader=a,window.PCELoader=l,window.VICELoader=r,window.NP2Loader=u,window.V86Loader=m,window.RuffleLoader=s,window.CloudpilotLoader=f,window.Emulator=A,window._SDL_CreateRGBSurfaceFrom=function(e,t,n,o,i,r,a,l,s){for(var u=SDL.makeSurface(t,n,0,!1,"CreateRGBSurfaceFrom",r,a,l,s),c=SDL.surfaces[u],f=c.ctx.getImageData(0,0,t,n),m=f.data,d=s?4:3,p=0;p<t*n;p++)m[4*p+0]=HEAPU8[e+(p*d+0)],m[4*p+1]=HEAPU8[e+(p*d+1)],m[4*p+2]=HEAPU8[e+(p*d+2)],m[4*p+3]=s?HEAPU8[e+(p*d+3)]:255;return c.ctx.putImageData(f,0,0),u}}("undefined"==typeof Promise?ES6Promise.Promise:Promise);var JSMESS=JSMESS||{};JSMESS.ready=function(e){e()};