/*!
 * @overview es6-promise - a tiny implementation of Promises/A+.
 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
 * @license   Licensed under MIT license
 *            See https://raw.githubusercontent.com/jakearchibald/es6-promise/master/LICENSE
 * @version   2.0.0
 */(function(){function t(t){return"function"==typeof t}var e,n,r,o,i,s=Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)},u=0,c=function(t,e){h[u]=t,h[u+1]=e,2===(u+=2)&&i()},a="undefined"!=typeof window?window:{},l=a.MutationObserver||a.WebKitMutationObserver,f="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,h=Array(1e3);function p(){for(var t=0;t<u;t+=2)(0,h[t])(h[t+1]),h[t]=void 0,h[t+1]=void 0;u=0}function _(){}"undefined"!=typeof process&&"[object process]"===({}).toString.call(process)?i=function(){process.nextTick(p)}:l?(e=0,n=new l(p),r=document.createTextNode(""),n.observe(r,{characterData:!0}),i=function(){r.data=e=++e%2}):f?((o=new MessageChannel).port1.onmessage=p,i=function(){o.port2.postMessage(0)}):i=function(){setTimeout(p,1)};var d=void 0,v=new j;function m(e,n){e===n?g(e,TypeError("You cannot resolve a promise with itself")):"function"==typeof n||"object"==typeof n&&null!==n?function(e,n){if(n.constructor===e.constructor)1===n._state?b(e,n._result):2===e._state?g(e,n._result):w(n,void 0,function(t){m(e,t)},function(t){g(e,t)});else{var r=function(t){try{return t.then}catch(t){return v.error=t,v}}(n);r===v?g(e,v.error):void 0===r?b(e,n):t(r)?c(function(t){var e=!1,o=function(t,e,n,r){try{t.call(e,n,r)}catch(t){return t}}(r,n,function(r){e||(e=!0,n!==r?m(t,r):b(t,r))},function(n){e||(e=!0,g(t,n))},"Settle: "+(t._label||" unknown promise"));!e&&o&&(e=!0,g(t,o))},e):b(e,n)}}(e,n):b(e,n)}function y(t){t._onerror&&t._onerror(t._result),A(t)}function b(t,e){t._state===d&&(t._result=e,t._state=1,0===t._subscribers.length||c(A,t))}function g(t,e){t._state===d&&(t._state=2,t._result=e,c(y,t))}function w(t,e,n,r){var o=t._subscribers,i=o.length;t._onerror=null,o[i]=e,o[i+1]=n,o[i+2]=r,0===i&&t._state&&c(A,t)}function A(t){var e=t._subscribers,n=t._state;if(0!==e.length){for(var r,o,i=t._result,s=0;s<e.length;s+=3)r=e[s],o=e[s+n],r?P(n,r,o,i):o(i);t._subscribers.length=0}}function j(){this.error=null}var E=new j;function P(e,n,r,o){var i,s,u,c,a=t(r);if(a){if((i=function(t,e){try{return t(e)}catch(t){return E.error=t,E}}(r,o))===E?(c=!0,s=i.error,i=null):u=!0,n===i){g(n,TypeError("A promises callback cannot return that same promise."));return}}else i=o,u=!0;n._state!==d||(a&&u?m(n,i):c?g(n,s):1===e?b(n,i):2===e&&g(n,i))}function T(t,e,n,r){this._instanceConstructor=t,this.promise=new t(_,r),this._abortOnReject=n,this._validateInput(e)?(this._input=e,this.length=e.length,this._remaining=e.length,this._init(),0===this.length?b(this.promise,this._result):(this.length=this.length||0,this._enumerate(),0===this._remaining&&b(this.promise,this._result))):g(this.promise,this._validationError())}T.prototype._validateInput=function(t){return s(t)},T.prototype._validationError=function(){return Error("Array Methods must be provided an Array")},T.prototype._init=function(){this._result=Array(this.length)},T.prototype._enumerate=function(){for(var t=this.length,e=this.promise,n=this._input,r=0;e._state===d&&r<t;r++)this._eachEntry(n[r],r)},T.prototype._eachEntry=function(t,e){var n=this._instanceConstructor;"object"==typeof t&&null!==t?t.constructor===n&&t._state!==d?(t._onerror=null,this._settledAt(t._state,e,t._result)):this._willSettleAt(n.resolve(t),e):(this._remaining--,this._result[e]=this._makeResult(1,e,t))},T.prototype._settledAt=function(t,e,n){var r=this.promise;r._state===d&&(this._remaining--,this._abortOnReject&&2===t?g(r,n):this._result[e]=this._makeResult(t,e,n)),0===this._remaining&&b(r,this._result)},T.prototype._makeResult=function(t,e,n){return n},T.prototype._willSettleAt=function(t,e){var n=this;w(t,void 0,function(t){n._settledAt(1,e,t)},function(t){n._settledAt(2,e,t)})};var S=0;function k(e){this._id=S++,this._state=void 0,this._result=void 0,this._subscribers=[],_!==e&&(t(e)||function(){throw TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof k||function(){throw TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}(),function(t,e){try{e(function(e){m(t,e)},function(e){g(t,e)})}catch(e){g(t,e)}}(this,e))}k.all=function(t,e){return new T(this,t,!0,e).promise},k.race=function(t,e){var n=new this(_,e);if(!s(t))return g(n,TypeError("You must pass an array to race.")),n;var r=t.length;function o(t){m(n,t)}function i(t){g(n,t)}for(var u=0;n._state===d&&u<r;u++)w(this.resolve(t[u]),void 0,o,i);return n},k.resolve=function(t,e){if(t&&"object"==typeof t&&t.constructor===this)return t;var n=new this(_,e);return m(n,t),n},k.reject=function(t,e){var n=new this(_,e);return g(n,t),n},k.prototype={constructor:k,then:function(t,e){var n=this._state;if(1===n&&!t||2===n&&!e)return this;var r=new this.constructor(_),o=this._result;if(n){var i=arguments[n-1];c(function(){P(n,r,i,o)})}else w(this,r,t,e);return r},catch:function(t){return this.then(null,t)}};var M={Promise:k,polyfill:function(){var e,n;"Promise"in(n="undefined"!=typeof global?global:"undefined"!=typeof window&&window.document?window:self)&&"resolve"in n.Promise&&"reject"in n.Promise&&"all"in n.Promise&&"race"in n.Promise&&(new n.Promise(function(t){e=t}),t(e))||(n.Promise=k)}};"function"==typeof define&&define.amd?define(function(){return M}):"undefined"!=typeof module&&module.exports?module.exports=M:void 0!==this&&(this.ES6Promise=M)}).call(this);